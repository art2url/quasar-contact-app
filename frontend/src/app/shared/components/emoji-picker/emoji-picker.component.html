<!-- Emoji button -->
<button
  type="button"
  class="emoji-button"
  (click)="togglePicker($event)"
  [disabled]="disabled"
  [attr.aria-label]="'Add emoji'">
  <svg
    width="20"
    height="20"
    viewBox="0 0 512 512"
    fill="currentColor"
    class="emoji-icon"
    aria-hidden="true">
    <g clip-path="url(#clip0_770_20169)">
      <path d="M244.522 0.262263C385.608 -6.07045 505.17 103.051 511.72 244.126C518.27 385.201 409.335 504.932 268.27 511.701C126.895 518.485 6.84581 409.259 0.280655 267.875C-6.2844 126.489 103.127 6.60884 244.522 0.262263ZM189.618 334.547C183.322 327.227 179.362 316.741 167.865 317.523C158.458 319.407 152.21 327.397 154.62 337.094C156.765 345.723 172.889 361.432 179.674 366.922C231.316 408.712 306.366 401.51 348.718 350.951C353.368 345.195 358.833 339.277 358.106 331.288C357.343 322.908 349.539 316.729 341.191 317.834C332.394 318.997 329.972 326.725 324.949 332.561C290.294 372.821 224.582 375.198 189.618 334.547ZM202.878 197.95C199.119 173.871 176.513 157.424 152.445 161.258C128.483 165.077 112.127 187.561 115.87 211.535C119.613 235.508 142.045 251.936 166.029 248.267C190.122 244.584 206.638 222.03 202.878 197.95ZM352.862 161.322C328.781 161.209 309.179 180.658 309.104 204.739C309.029 228.818 328.512 248.389 352.592 248.423C376.616 248.457 396.13 229.031 396.204 205.006C396.278 180.982 376.884 161.437 352.862 161.322Z" />
    </g>
    <defs>
      <clipPath id="clip0_770_20169">
        <rect width="512" height="512" fill="white"/>
      </clipPath>
    </defs>
  </svg>
</button>

<!-- Emoji picker dropdown -->
<div *ngIf="showPicker" class="emoji-picker" (click)="onPickerClick($event)" (keydown)="onKeyDown($event)" tabindex="-1" aria-label="Emoji picker">
  <div class="emoji-grid">
    <button
      *ngFor="let emoji of popularEmojis"
      class="emoji-option"
      (click)="onEmojiClick(emoji)"
      (keydown.enter)="onEmojiClick(emoji)"
      (keydown.space)="onEmojiClick(emoji)"
      [title]="emoji"
      [attr.aria-label]="emoji">
      {{ emoji }}
    </button>
  </div>
</div>